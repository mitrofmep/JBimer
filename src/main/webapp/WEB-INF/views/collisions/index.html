<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Collisions</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.6.0/css/bootstrap.min.css" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-aFq/bzH65dt+w6FI2ooMVUpc+21e0SRygnTpmBvdBgSdnuTN7QbdgL+OapgHtvPp" crossorigin="anonymous">
</head>
<body>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha2/dist/js/bootstrap.bundle.min.js" integrity="sha384-qKXV1j0HvMUeCBQ+QVp7JcfGl760yU08IQ+GpUo5hlbpg51QRiuqHAJz8+BrxE/N" crossorigin="anonymous"></script>
<br/>
<div class="text-center border p-2">
    Collisions on page <span class="badge bg-secondary" th:text="${collisions.size()}"></span>
</div>

<br/>
<div class="container">
<div>
    <table class="table table-bordered">
        <thead>
        <tr>
            <th scope="col">Info</th>
            <th scope="col">Status</th>
            <th scope="col">Disc-1</th>
            <th scope="col">Element ID-1</th>
            <th scope="col">Element Name-1</th>
            <th scope="col">Disc-2</th>
            <th scope="col">Element ID-2</th>
            <th scope="col">Element Name-2</th>
            <th scope="col">Assigned to</th>
            <th scope="col">Fake</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="collision : ${collisions}" th:sorted>
            <td><a th:href="@{/collisions/{id}(id=${collision.getId()})}" class="btn btn-primary btn-sm" role="button">Open</a></td>
            <td><span th:text="${collision.getStatus()}"></span></td>
            <td><span th:text="${collision.getDiscipline1()}"></span></td>
            <td><span th:text="${collision.getElementId1()+ '  '}"></span><button class="btn btn-light btn-sm" onclick="copyToClipboard(this)" th:attr="data-clipboard-text=${collision.getElementId1()}">ðŸ“‹</button></td>
            <td><span th:text="${collision.getElementName1()}"></span></td>
            <td><span th:text="${collision.getDiscipline2()}"></span></td>
            <td><span th:text="${collision.getElementId2()+ '  '}"></span><button class="btn btn-light btn-sm" onclick="copyToClipboard(this)" th:attr="data-clipboard-text=${collision.getElementId2()}">ðŸ“‹</button></td>
            <td><span th:text="${collision.getElementName2()}"></span></td>
            <td><span th:text="${collision.getEngineer() != null} ? ${collision.getEngineer().getFullNameWithDiscipline()} : 'Ð¡Ð²Ð¾Ð±Ð¾Ð´Ð½Ð¾'"
        th:style="${collision.getEngineer() != null} ? '' : 'color:green'"></span>
            </td>
            <td><span th:if="${collision.isFake()}" class="text-danger">FAKE</span>
                <span th:unless="${collision.isFake()}">
        <a th:href="@{/collisions/{id}/fake(id=${collision.getId()})}" class="btn btn-warning btn-sm" role="button">Mark as fake</a>
    </span>
            </td>
        </tr>
        </tbody>
    </table>
</div>
</div>

<style>
    .btn-color-transition {
        transition: background-color 0.5s ease-in-out;
    }
</style>
<script>
    function copyToClipboard(button) {
        var text = button.dataset.clipboardText;
        var dummy = document.createElement("textarea");
        document.body.appendChild(dummy);
        dummy.value = text;
        dummy.select();
        document.execCommand("copy");
        document.body.removeChild(dummy);

        button.classList.remove("btn-light");
        button.classList.add("btn-success", "btn-color-transition");
        button.innerText = "âœ…";
        button.disabled = true;

        setTimeout(function() {
            button.classList.remove("btn-success", "btn-color-transition");
            button.classList.add("btn-light", "btn-color-transition");
            button.innerText = "ðŸ“‹";
            button.disabled = false;
        }, 2000);
    }
</script>
<!--<a href="/collisions/new">Add new</a>-->
<br/>
<a href="/main">Back to main</a>
<br/>
<a href="/engineers">All engineers</a>

<form th:method="POST" th:action="@{/collisions/search}">
    <label for="query">Enter : </label>
    <input type="text" id="query" name="query"/>
    <br/>
    <input type="submit" value="Search!"/>
</form>
</body>
</html>